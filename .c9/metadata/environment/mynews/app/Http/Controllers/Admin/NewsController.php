{"filter":false,"title":"NewsController.php","tooltip":"/mynews/app/Http/Controllers/Admin/NewsController.php","undoManager":{"mark":11,"position":11,"stack":[[{"start":{"row":4,"column":0},"end":{"row":45,"column":0},"action":"remove","lines":["​","// 以下を追記することでNews Modelが扱えるようになる","use App\\News;","​","class NewsController extends Controller","{","  public function add()","  {","      return view('admin.news.create');","  }","​","　public function create(Request $request)","  {","​","      // 以下を追記","      // Varidationを行う","      $this->validate($request, News::$rules);","​","      $news = new News;","      $form = $request->all();","​","      // フォームから画像が送信されてきたら、保存して、$news->image_path に画像のパスを保存する","      if (isset($form['image'])) {","        $path = $request->file('image')->store('public/image');","        $news->image_path = basename($path);","      } else {","          $news->image_path = null;","      }","​","      // フォームから送信されてきた_tokenを削除する","      unset($form['_token']);","      // フォームから送信されてきたimageを削除する","      unset($form['image']);","​","      // データベースに保存する","      $news->fill($form);","      $news->save();","​","      return redirect('admin/news/create');","  }","}",""],"id":2}],[{"start":{"row":35,"column":0},"end":{"row":36,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":37,"column":0},"end":{"row":53,"column":3},"action":"insert","lines":["<?php","namespace App\\Http\\Controllers\\Admin;","use Illuminate\\Http\\Request;","use App\\Http\\Controllers\\Controller;","​","// 以下を追記することでNews Modelが扱えるようになる","use App\\News;","​","class NewsController extends Controller","{","  public function add()","  {","      return view('admin.news.create');","  }","​","　public function create(Request $request)","  {"],"id":4}],[{"start":{"row":37,"column":4},"end":{"row":37,"column":5},"action":"remove","lines":["p"],"id":5},{"start":{"row":37,"column":3},"end":{"row":37,"column":4},"action":"remove","lines":["h"]},{"start":{"row":37,"column":2},"end":{"row":37,"column":3},"action":"remove","lines":["p"]},{"start":{"row":37,"column":1},"end":{"row":37,"column":2},"action":"remove","lines":["?"]},{"start":{"row":37,"column":0},"end":{"row":37,"column":1},"action":"remove","lines":["<"]},{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":42,"column":11},"end":{"row":42,"column":12},"action":"remove","lines":["s"],"id":6},{"start":{"row":42,"column":10},"end":{"row":42,"column":11},"action":"remove","lines":["w"]},{"start":{"row":42,"column":9},"end":{"row":42,"column":10},"action":"remove","lines":["e"]},{"start":{"row":42,"column":8},"end":{"row":42,"column":9},"action":"remove","lines":["N"]}],[{"start":{"row":42,"column":8},"end":{"row":42,"column":15},"action":"insert","lines":["Profile"],"id":7}],[{"start":{"row":41,"column":13},"end":{"row":41,"column":17},"action":"remove","lines":["News"],"id":13},{"start":{"row":41,"column":13},"end":{"row":41,"column":20},"action":"insert","lines":["Profile"]}],[{"start":{"row":52,"column":3},"end":{"row":53,"column":0},"action":"insert","lines":["",""],"id":14},{"start":{"row":53,"column":0},"end":{"row":53,"column":6},"action":"insert","lines":["      "]},{"start":{"row":53,"column":6},"end":{"row":54,"column":0},"action":"insert","lines":["",""]},{"start":{"row":54,"column":0},"end":{"row":54,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":54,"column":5},"end":{"row":54,"column":6},"action":"remove","lines":[" "],"id":15},{"start":{"row":54,"column":4},"end":{"row":54,"column":5},"action":"remove","lines":[" "]},{"start":{"row":54,"column":0},"end":{"row":54,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":54,"column":0},"end":{"row":55,"column":0},"action":"insert","lines":["",""],"id":16}],[{"start":{"row":55,"column":0},"end":{"row":82,"column":0},"action":"insert","lines":["      // 以下を追記","      // Varidationを行う","      $this->validate($request, News::$rules);","​","      $news = new News;","      $form = $request->all();","​","      // フォームから画像が送信されてきたら、保存して、$news->image_path に画像のパスを保存する","      if (isset($form['image'])) {","        $path = $request->file('image')->store('public/image');","        $news->image_path = basename($path);","      } else {","          $news->image_path = null;","      }","​","      // フォームから送信されてきた_tokenを削除する","      unset($form['_token']);","      // フォームから送信されてきたimageを削除する","      unset($form['image']);","​","      // データベースに保存する","      $news->fill($form);","      $news->save();","​","      return redirect('admin/news/create');","  }","}",""],"id":17}],[{"start":{"row":57,"column":32},"end":{"row":57,"column":36},"action":"remove","lines":["News"],"id":19},{"start":{"row":57,"column":32},"end":{"row":57,"column":39},"action":"insert","lines":["Profile"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":69,"column":1},"end":{"row":69,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1582114224061,"hash":"8df5431ced6a5eda6413694109be07954437caff"}